<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Radio Online|La Voz de OIENIV</title>
    <!--<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
        <script src="https://unpkg.com/vue/dist/vue.min.js"></script>-->
        <script src="frameworks/vue.js"></script>
<script src="https://www.gstatic.com/firebasejs/4.13.0/firebase.js"></script>
    <link rel="stylesheet" href="css/style-radio.css">
    <!--<link href="https://fonts.googleapis.com/css?family=Roboto|Lobster" rel="stylesheet">-->
    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
    <script>  var config = {
    apiKey: "AIzaSyC2RvmGHYtaqUa5lEXb3MLl_Mv4ECiLoBE",
    authDomain: "chat-lavozdeoieniv.firebaseapp.com",
    databaseURL: "https://chat-lavozdeoieniv.firebaseio.com",
    projectId: "chat-lavozdeoieniv",
    storageBucket: "chat-lavozdeoieniv.appspot.com",
    messagingSenderId: "24315564955"
  };
  firebase.initializeApp(config);
        var TablaDeBaseDatos = firebase.database().ref('chat');
        TablaDeBaseDatos.on('value', snapshot => {
            data.chatMessages = []
            snapshot.forEach(e => {
                let objeto = e.val();
                if ((objeto.message != null) && (objeto.user != null)) {
                    data.chatMessages.push(objeto);
                }
            }
            );
        }
        );
    </script>
</head>
<body>
    <div id="fb-root"></div>
        <script>
            var finished_rendering = function () {
                    console.log("finished rendering plugins");
                    var spinner = document.getElementById("spinner");
                    spinner.removeAttribute("style");
                    spinner.removeChild(spinner.childNodes[0]);
                };

            window.fbAsyncInit = function() {
                FB.init({
                    appId: '484795955226627',
                    cookie: true,
                    xfbml: true,
                    version: 'v2.12'
                });
            FB.AppEvents.logPageView();
            FB.Event.subscribe('xfbml.render', finished_rendering);

        };
           function testAPI() {
                FB.api('/me',response => {
                    app.chat.user = response.name;
                    localStorage.setItem("Nombre", response.name)
                    
                });
                FB.api('/me/picture?redirect=false', res =>{
                    app.chat.pic = res.data.url;
                    localStorage.setItem("pic", res.data.url);
                    
                })
                app.show = false;
                app.showModal = false;
            }
  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/es_LA/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
    </script>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <script>var data = {
                show: true,
                showModal: false,
                isVisible: false,
                display:"none", 
                opacity:0,
                animation:"",
                chat: {
                    message: "",
                    user: "",
                    pic: "",
                },
                chatMessages: [],
                progItems: [{
                    id: "tropi",
                    prog: "Tropicalisima",
                    hora: "De 5P.M. a 7P.M.",
                    dia: "Sabados",
                    locutor: "Bernardo Romero",
                    des: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum.",
                    img: "images/user.jpg"
                }, {
                    id: "tropi",
                    prog: "Tropicalisima",
                    hora: "De 5P.M. a 7P.M.",
                    dia: "Sabados",
                    locutor: "Bernardo Romero",
                    des: "Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum.",
                    img: "images/user.jpg"
                }]
            };
            var dataProg = {
                vista: true,
                preHeight: "340px",
                style: {
                    img: {
                        animation: ""
                    }
                },
                no: {
                    style: {
                        des: {
                            display: "none",
                            opacity: 0,
                            transition: ".5s ease"
                        },
                        img: {
                            animation: ""
                        },
                        bloqueProg: {},
                        verMas: {},
                        verMenos: {
                            display: "none"
                        }
                    }
                },
                numbers: []
            }
            if (!localStorage.getItem("Nombre") && !localStorage.getItem("pic")) {
                data.chat.user = "";
                data.chat.pic = "";
            } else {
                data.chat.user = localStorage.getItem("Nombre");
                data.chat.pic = localStorage.getItem("pic");
            }
        </script>
    <div id="app">
    <header>
            <menu-item 
             index="index.html" 
             radio="" 
             fotos="Galeria/fotos.html" 
             videos="Galeria/videos.html" 
             nosotros="nosotros.html"
             logo="images/logo.png"></menu-item>
    </header>
    <div class="online"></div>
    <div id="modal">
        <div id="modal-shadow" :style="{animation:animation, display:display, opacity:opacity}"></div>
            <div class="modal mdl-dialog" :style="{animation:animation, display:display, opacity:opacity}">
                <div class="dialog-header">
                    <button 
                    type="button" 
                    class="mdl-button mdl-color--amber-800 close" 
                    @click="showModal = false">Cerrar</button>
                </div>
                <h4 class="mdl-dialog__title">Ingresa tu nombre</h4>
                <div class="mdl-dialog__content">
                    <div 
                     id="ingresa-nombre" 
                     class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                        <input 
                         v-model="chat.user" 
                         class="mdl-textfield__input" 
                         type="text" 
                         id="ingresaNombre" 
                         name="ingresaNombre">
                        <label 
                         class="mdl-textfield__label" 
                         for="ingresaNombre"
                         >Nombre
                        </label>
                        <button 
                         type="button" 
                         class="mdl-button mdl-color--amber-800" 
                         onclick="ingresaNombre()" 
                         id="btnNombre"
                         >Enviar
                        </button>
                    </div>
                    <h1 class="mdl-dialog__title o">Ó</h1>
                    <div id="spinner" style="
                            background: #4267b2;
                            border-radius: 5px;
                            color: white;
                            height: 40px;
                            width: 250px;
                            margin: auto">
                        <img 
                        src="images/double-tail-spin.svg" 
                        alt="" 
                        style="
                            animation: rotate infinite linear 1s;
                            height: 35px;
                            margin-top: 2.5px">
                        <div class="fb-login-button" 
                         data-max-rows="1" 
                         data-size="large" 
                         data-button-type="continue_with" 
                         data-show-faces="false"
                         data-auto-logout-link="false" 
                         data-use-continue-as="true"
                         onlogin="testAPI">
                        </div>                    
                    </div>
                </div>
            </div>
    </div>
        <!--<template>
            <div id="modal-shadow"></div>
            <div class="modal mdl-dialog">
                <div class="dialog-header">
                    <button type="button" class="mdl-button mdl-color--amber-800 close" @click="display = 'none', opa = 0">Cerrar</button>
                </div>
                <h4 class="mdl-dialog__title">Nombre del usuario</h4>
                <div class="mdl-dialog__content">
                    <div id="ingresa-nombre" class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
                        <input v-model="chat.user" class="mdl-textfield__input" type="text" id="ingresaNombre" name="ingresaNombre">
                        <label class="mdl-textfield__label" for="ingresaNombre">Nombre del usuario</label>
                        <button type="button" class="mdl-button mdl-color--amber-800" onclick="ingresaNombre()" id="btnNombre">Enviar</button>
                    </div>
                    <h1 class="mdl-dialog__title o">Motivo</h1>
                    
                </div>
                <div class="mdl-dialog__actions"></div>
            </div>
        </template>-->
    <div class="cuerpo">
        <div class="panel-cabecera">
            <button id="demo-menu-lower-right" class="mdl-color--amber-800 pull-right mdl-button mdl-js-button mdl-button--icon">
                <span class="icon-menu"></span>
            </button>
            <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="demo-menu-lower-right">
                <li class="mdl-menu__item">Reportar Mensaje</li>
            </ul>
        </div>
        <div class="panel-cuerpo" id="chat">
            <ul class="chat">
                <chat-template v-for="iten in chatMessages"
                 :user="iten.user"
                 :pic="iten.pic"
                 :message="iten.message"
                 :date="iten.date"
                 :key="iten.id"
                ></chat-template>
            </ul>
        </div>
        <div class="panel-pie" id="panel">
            <template v-if="show">
                <div class="ingresa">
                    <button 
                     id="boton-nombre" 
                     class="mdl-button mdl-js-button mdl-color--amber-800" 
                     @click="showModal = true"
                     >Ingresar Nombre
                    </button>
                </div>
            </template>
            <template v-else>
                <form @submit="sendMessage">
                    <div class="input-group">
                        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="msj">
                            <input class="mdl-textfield__input" type="text" id="Mensaje" value="" name="Mensaje" v-model="chat.message">
                            <label class="mdl-textfield__label" for="Mensaje">Ingresa tu mensaje</label>
                        </div>
                        <button class="mdl-button mdl-js-button mdl-color--amber-800" id="btnEnviar" type="submit" style="height: 36px;">Enviar</button>
                    </div>
                </form>
            </template>

        </div>
    </div>
    <div class="bloque-der">
        <div class="programas">
            <bloque-prog id="tropi" programa="Tropicalisima" hora="De 5P.M. a 7P.M." dia="Sabados" locutor="Bernardo Romero"
                descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
            <bloque-prog id="voz" programa="Voz que que clama en el desierto" hora="De 7P.M. a 8P.M." dia="Miercoles"
                locutor="Elizama Patiño" descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
            <bloque-prog id="hora" programa="La hora de la intersecion" hora="De 7P.M. a 8P.M." dia="Martes"
                locutor="Agustin Sanchez y el equipo de oracion" descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
            <bloque-prog id="entre" programa="Entrelazados" hora="De 10A.M. a 11P.M." dia="Sabados" locutor="Debonish y Marisol Ortega"
                descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
            <bloque-prog id="tribu" programa="La Tribu" hora="De 4P.M. a 5P.M." dia="Sabados" locutor="Francisco Infante"
                descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
            <bloque-prog id="vene" programa="Venezuela Para Cristo" hora="De 8A.M. a 9A.M." dia="Sabados" locutor="Agustin Sanchez Romero"
                descripcion="Lorem ipsum dolor sit amet consectetur adipisicing elit. Libero possimus in facilis fugit aspernatur! Tempore, beatae. Quos unde blanditiis officia doloribus! Culpa inventore fugit odit officia eveniet exercitationem! Debitis, harum."
                img="images/user.jpg"></bloque-prog>
        </div>
    </div>
    <aside class="lateral"></aside>
    <div class="publicidad pull-left"></div>
    <item-footer index="index.html" logo="images/logo.png"></item-footer>

</div>
    <script src="js/plantillas.js"></script>
    <script src="js/listen.js"></script>

    <script>
    var app = new Vue({
        el:"#app",
        data:data,
        methods:{
            sendMessage: function (e) {
                e.preventDefault(); let formatofecha = new Date();
                let d = formatofecha.getUTCDate();
                let m = formatofecha.getMonth() + 1;
                let y = formatofecha.getFullYear();
                let h = formatofecha.getHours();
                let min = formatofecha.getMinutes();
                let Fecha = `${d}/${m}/${y} ${h}:${min}`;
                if (this.chat.message && this.chat.user) {
                    TablaDeBaseDatos.push({
                        message: this.chat.message, user: this.chat.user, pic: this.chat.pic, date: Fecha
                    });
                    this.chat.message = "";
                }
            }
        },
        watch:{
            showModal:function(e){
                if(e){
                    this.animation = "fade-in ease 1s";
                    this.display = "block";
                    this.opacity = 1;
                } else {
                    let that = this;
                    this.animation = "fade-out ease 1s";
                    setTimeout(() => {
                        that.opacity = 0;
                        that.display = "none";
                    }, 1000);
                }
            }, 
        }
    })
    function face() {
            window.open("https://www.facebook.com/lavozdeoieniv", "_blank")
        }

        function twit() {
            window.open("https://www.twitter.com/lavozdeoieniv", "_blank")
        }

        function inst() {
            window.open("https://www.instagram.com/lavozdeoieniv", "_blank")
        }

        function yt() {
            window.open("https://www.youtube.com/channel/UCjqEhezX3BmaWfp6UXgQxvg", "_blank")
        }

        var openFace = document.querySelector("#icon-face");
        openFace.addEventListener("click", face, false);
        var openTwit = document.querySelector("#icon-twit");
        openTwit.addEventListener("click", twit, false);
        var openInst = document.querySelector("#icon-inst");
        openInst.addEventListener("click", inst, false);
        var openYt = document.querySelector("#icon-yt");
        openYt.addEventListener("click", yt, false);
        function carga() {
            if (localStorage.getItem("Nombre")) {
                data.show = false;
                data.showModal = false;
                Nombre = localStorage.getItem("Nombre");
            }
            else {
                data.show = true;
            }
            return data.show,
                data.showModa;
        }
        window.addEventListener("load", carga, false);
        function ingresaNombre() {
            let Nombre = document.getElementById("ingresaNombre").value;
            localStorage.setItem("Nombre", Nombre);
            let pic = "http://placehold.it/50/55C1E7/fff&text=U"
            localStorage.setItem("pic", pic)
            data.chat.pic = pic;
            if (Nombre != undefined && Nombre != "" && Nombre != null) {
                data.show = false;
                data.showModal = false;
            }
        }
    </script>
    <script src="js/mas.js"></script>
    <style></style>
    <style>
    @keyframes fade-in {
            0%{
                opacity:0;
            display:"none"
            }
            100%{
                opacity:1;
                display:"block";
            }
            }
        @keyframes fade-out {
            0%{
                opacity:1;
            display:"block"
            }
            100%{
                opacity:0;
                display:"none";
            }
            }
            @keyframes rotate {
                0%{
                    transform: rotate(0deg)
                }100%{
                    transform: rotate(360deg)
                }
            }
    </style>
</body>

</html>
